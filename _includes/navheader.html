  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
    <div class="container">
	  <a class="navbar-brand js-scroll-trigger" href="{{ site.baseurl }}/">
          {%- if site.logo -%}
            <img height="{{ site.logo.height | default: 52 }}" src="{{ site.logo.path }}"/>
          {%- else -%}
            <div class="brand-container">
              <span class="brand-text">{{ site.title }}</span>
              <span class="brand-divider">|</span>
              <img src="assets/img/ssu-logo.png" alt="SSU Logo" class="ssu-logo-nav">
            </div>
          {%- endif -%}
      </a>
      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        Menu
        <i class="fas fa-bars"></i>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav text-uppercase ml-auto">
        {% if site.locale and site.locale != "" and site.locale != nil %}
        {% for link in site.data.navigation[site.locale].nav %}
          <li class="nav-item{% if link.dropdown %} dropdown{% endif %}">
            {%- if link.dropdown -%}
              <a class="nav-link dropdown-toggle{% if link.title == 'AI' %} ai-menu-circular{% endif %}" href="{{ link.url | default: '#' }}" id="navbarDropdown{{ forloop.index }}" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                {% if link.title == 'AI' %}<svg width="22" height="22" viewBox="0 0 512 512"><defs><linearGradient id="blueGradient" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#3B82F6;stop-opacity:1" /><stop offset="50%" style="stop-color:#2563EB;stop-opacity:1" /><stop offset="100%" style="stop-color:#1D4ED8;stop-opacity:1" /></linearGradient></defs><path fill="url(#blueGradient)" d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"/></svg>{% else %}{{ link.title }} <span class="dropdown-arrow" style="margin-left: 8px; color: #007bff; font-size: 14px; font-weight: bold;">&#9662;</span>{% endif %}
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown{{ forloop.index }}">
                {% for sublink in link.dropdown %}
                  <a class="dropdown-item{% if sublink.class %} {{ sublink.class }}{% endif %}" href="{{ sublink.url }}"{% if sublink.onclick %} onclick="{{ sublink.onclick }}"{% endif %}>
                    <div class="dropdown-item-content">
                      {% if sublink.icon %}<i class="{{ sublink.icon }}"></i>{% endif %}
                      <div class="dropdown-item-text">
                        <strong>{{ sublink.title }}</strong>
                        {% if sublink.desc %}<small>{{ sublink.desc }}</small>{% endif %}
                      </div>
                    </div>
                  </a>
                {% endfor %}
              </div>
            {%- elsif link.url -%}
              <a class="nav-link" href="{{ link.url }}">{{ link.title }}</a>
            {%- elsif link.section -%}
              <a class="nav-link js-scroll-trigger" href="#{{ link.section }}">{{ link.title }}</a>
            {%- elsif link.id -%}
              <a class="nav-link" href="#" id="{{ link.id }}">{{ link.title }}</a>
            {%- else -%}
              <a class="nav-link" href="#">{{ link.title }}</a>
            {%- endif -%}
          </li>
        {% endfor %}
        {% else %}
        {% for link in site.data.navigation.nav %}
        <li class="nav-item{% if link.dropdown %} dropdown{% endif %}">
          {%- if link.dropdown -%}
            <a class="nav-link dropdown-toggle{% if link.title == 'AI' %} ai-menu-circular{% endif %}" href="{{ link.url | default: '#' }}" id="navbarDropdown{{ forloop.index }}" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              {% if link.title == 'AI' %}<svg style="height: 1.87em; width: 1.87em;" viewBox="0 0 512 512"><path fill="#3B82F6" d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"/><text x="208" y="250" text-anchor="middle" font-size="273" font-weight="600" fill="#3B82F6" font-family="Arial, sans-serif">AI</text></svg>{% else %}{{ link.title }} <span class="dropdown-arrow" style="margin-left: 8px; color: #007bff; font-size: 14px; font-weight: bold;">&#9662;</span>{% endif %}
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown{{ forloop.index }}">
              {% for sublink in link.dropdown %}
                <a class="dropdown-item{% if sublink.class %} {{ sublink.class }}{% endif %}" href="{{ sublink.url }}"{% if sublink.onclick %} onclick="{{ sublink.onclick }}"{% endif %}>
                  <div class="dropdown-item-content">
                    {% if sublink.icon %}<i class="{{ sublink.icon }}"></i>{% endif %}
                    <div class="dropdown-item-text">
                      <strong>{{ sublink.title }}</strong>
                      {% if sublink.desc %}<small>{{ sublink.desc }}</small>{% endif %}
                    </div>
                  </div>
                </a>
              {% endfor %}
            </div>
          {%- elsif link.url -%}
            <a class="nav-link" href="{{ link.url }}">{{ link.title }}</a>
          {%- elsif link.section -%}
            <a class="nav-link js-scroll-trigger" href="#{{ link.section }}">{{ link.title }}</a>
          {%- elsif link.id -%}
            <a class="nav-link" href="#" id="{{ link.id }}">{{ link.title }}</a>
          {%- else -%}
            <a class="nav-link" href="#">{{ link.title }}</a>
          {%- endif -%}
        </li>
        {% endfor %}
        {% endif %}
        </ul>
      </div>
    </div>
  </nav>
  <!-- End Navigation -->
  
  <!-- Header -->
  {% if site.locale and site.locale != "" and site.locale != nil %}
  <header class="masthead">
    <div class="container">
      <div class="intro-text text-center">
        {%- if site.data.sitetext[site.locale].header.title -%}
        <div class="intro-lead-in">{{ site.data.sitetext[site.locale].header.title | markdownify }}</div>
        {%- endif -%}
        {%- if site.data.sitetext[site.locale].header.text -%}
        <div class="intro-heading text-uppercase">{{ site.data.sitetext[site.locale].header.text | markdownify }}</div>
        {%- endif -%}
      </div>
      
      <div class="image-slider-container">
        <div class="image-slider">
          <div class="slider-content-wrapper">
            {%- if site.data.sitetext[site.locale].header.slider -%}
            {% for slide in site.data.sitetext[site.locale].header.slider %}
            <div class="slider-image {% if forloop.first %}active{% endif %}">
              <img src="{{ slide.image }}" alt="{{ slide.title }}" class="img-fluid">
            </div>
            {% endfor %}
            {%- endif -%}
          </div>
        </div>
      </div>
      
      <div class="research-tabs-container">
        <div class="research-tabs">
          {%- if site.data.sitetext[site.locale].header.slider -%}
          {% for slide in site.data.sitetext[site.locale].header.slider %}
          <div class="research-tab {% if forloop.first %}active{% endif %}" data-index="{{ forloop.index0 }}">
            <h3 class="tab-title">{{ slide.title }}</h3>
            <p class="tab-description">{{ slide.description }}</p>
          </div>
          {% endfor %}
          {%- endif -%}
        </div>
      </div>
      
      <div class="button-container text-center">
        {%- if site.data.sitetext[site.locale].header.button -%}
        <a class="btn btn-primary btn-xl text-uppercase js-scroll-trigger" href="{{ site.data.sitetext[site.locale].header.buttonlink }}">{{ site.data.sitetext[site.locale].header.button }}</a>
        {%- endif -%}
      </div>
    </div>
  </header>
  {% else %}
  <header class="masthead">
    <div class="container">
      <div class="intro-text text-center">
        {%- if site.data.sitetext.header.title -%}
        <div class="intro-lead-in">{{ site.data.sitetext.header.title | markdownify }}</div>
        {%- endif -%}
        {%- if site.data.sitetext.header.text -%}
        <div class="intro-heading text-uppercase">{{ site.data.sitetext.header.text | markdownify }}</div>
        {%- endif -%}
      </div>
      
      <div class="image-slider-container">
        <div class="image-slider">
          <div class="slider-content-wrapper">
            {%- if site.data.sitetext.header.slider -%}
            {% for slide in site.data.sitetext.header.slider %}
            <div class="slider-image {% if forloop.first %}active{% endif %}">
              <img src="{{ slide.image }}" alt="{{ slide.title }}" class="img-fluid">
            </div>
            {% endfor %}
            {%- endif -%}
          </div>
        </div>
      </div>
      
      <div class="research-tabs-container">
        <div class="research-tabs">
          {%- if site.data.sitetext.header.slider -%}
          {% for slide in site.data.sitetext.header.slider %}
          <div class="research-tab {% if forloop.first %}active{% endif %}" data-index="{{ forloop.index0 }}">
            <h3 class="tab-title">{{ slide.title }}</h3>
            <p class="tab-description">{{ slide.description }}</p>
          </div>
          {% endfor %}
          {%- endif -%}
        </div>
      </div>
      
      <div class="button-container text-center">
        {%- if site.data.sitetext.header.button -%}
        <a class="btn btn-primary btn-xl text-uppercase js-scroll-trigger" href="{{ site.data.sitetext.header.buttonlink }}">{{ site.data.sitetext.header.button }}</a>
        {%- endif -%}
      </div>
    </div>
  </header>
  {% endif %}
  <!-- End Header -->

<style>
.intro-lead-in {
  margin-top: 60px !important;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const dropdownItems = document.querySelectorAll('.navbar-nav .dropdown');
  let activeDropdown = null;
  let timeoutId = null;
  let lastMousePos = { x: 0, y: 0 };
  
  dropdownItems.forEach(dropdown => {
    const menu = dropdown.querySelector('.dropdown-menu');
    
    dropdown.addEventListener('mouseenter', function() {
      clearTimeout(timeoutId);
      
      // Hide other dropdowns
      dropdownItems.forEach(item => {
        if (item !== dropdown) {
          item.querySelector('.dropdown-menu').style.display = 'none';
          item.querySelector('.dropdown-menu').style.opacity = '0';
          
          // Reset other chevrons
          const otherChevron = item.querySelector('i.fa-chevron-down');
          if (otherChevron) {
            otherChevron.style.transform = 'rotate(0deg)';
          }
        }
      });
      
      // Show current dropdown
      menu.style.display = 'block';
      menu.style.opacity = '1';
      menu.style.transform = 'translateY(0)';
      
      // Rotate chevron
      const chevron = dropdown.querySelector('i.fa-chevron-down');
      if (chevron) {
        chevron.style.transform = 'rotate(180deg)';
      }
      
      activeDropdown = dropdown;
    });
    
    dropdown.addEventListener('mouseleave', function(e) {
      const rect = menu.getBoundingClientRect();
      const mouseX = e.clientX;
      const mouseY = e.clientY;
      
      // Check if mouse is moving towards the dropdown menu
      const menuLeft = rect.left;
      const menuRight = rect.right;
      const menuTop = rect.top;
      
      const isMovingTowards = mouseX >= menuLeft - 20 && mouseX <= menuRight + 20 && 
                             mouseY >= menuTop - 20;
      
      if (isMovingTowards) {
        // Give more time if moving towards dropdown
        timeoutId = setTimeout(() => {
          if (activeDropdown === dropdown) {
            menu.style.display = 'none';
            menu.style.opacity = '0';
            menu.style.transform = 'translateY(-10px)';
            
            // Reset chevron
            const chevron = dropdown.querySelector('i.fa-chevron-down');
            if (chevron) {
              chevron.style.transform = 'rotate(0deg)';
            }
            
            activeDropdown = null;
          }
        }, 300); // 300ms delay
      } else {
        // Hide immediately if not moving towards dropdown
        timeoutId = setTimeout(() => {
          if (activeDropdown === dropdown) {
            menu.style.display = 'none';
            menu.style.opacity = '0';
            menu.style.transform = 'translateY(-10px)';
            
            // Reset chevron
            const chevron = dropdown.querySelector('i.fa-chevron-down');
            if (chevron) {
              chevron.style.transform = 'rotate(0deg)';
            }
            
            activeDropdown = null;
          }
        }, 150);
      }
    });
    
    // Keep dropdown open when hovering over the menu itself
    menu.addEventListener('mouseenter', function() {
      clearTimeout(timeoutId);
    });
    
    menu.addEventListener('mouseleave', function() {
      timeoutId = setTimeout(() => {
        menu.style.display = 'none';
        menu.style.opacity = '0';
        menu.style.transform = 'translateY(-10px)';
        
        // Reset chevron
        const chevron = dropdown.querySelector('i.fa-chevron-down');
        if (chevron) {
          chevron.style.transform = 'rotate(0deg)';
        }
        
        activeDropdown = null;
      }, 150);
    });
  });
  
  // Track mouse movement
  document.addEventListener('mousemove', function(e) {
    lastMousePos.x = e.clientX;
    lastMousePos.y = e.clientY;
  });
});
</script>