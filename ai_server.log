/home/i0179/lib/python3.10/site-packages/requests/__init__.py:86: RequestsDependencyWarning: Unable to find acceptable character detection dependency (chardet or charset_normalizer).
  warnings.warn(
INFO:__main__:Starting Reality Lab Qwen3-4B Server (4-bit) on port 4005...
INFO:__main__:Loading Qwen3-4B tokenizer from local path
INFO:__main__:Loading Qwen3-4B model with 4-bit quantization
INFO:accelerate.utils.modeling:We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:02<00:05,  2.98s/it]Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:06<00:03,  3.30s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:06<00:00,  2.20s/it]
INFO:__main__:âœ… Qwen3-4B model loaded successfully with 4-bit quantization
INFO:__main__:Model vocab size: 151936, Tokenizer vocab size: 151669
INFO:__main__:PAD token ID: 151643, EOS token ID: 151645
INFO:__main__:Loading RAG system...
INFO:sentence_transformers.SentenceTransformer:Use pytorch device_name: cuda:0
INFO:sentence_transformers.SentenceTransformer:Load pretrained SentenceTransformer: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
INFO:__main__:âœ… RAG system loaded successfully!
INFO:__main__:â±ï¸  Idle timeout enabled: server will shutdown after 120s of inactivity
INFO:__main__:ðŸš€ Qwen3-4B server ready on port 4005!
INFO:__main__:âœ… Running with HTTP (no SSL)
Loading Hierarchical RAG from: /home/i0179/Realitylab-site/ai_server/hierarchical_rag
  Loading embedding model: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
  âœ… faculty: 2 docs
  âœ… students: 23 docs
  âœ… alumni: 17 docs
  âœ… news: 19 docs
  âœ… publications: 37 docs
  âœ… lab_info: 1 docs
âœ… Hierarchical RAG ready!
 * Serving Flask app 'qwen3_4b_lowmem'
 * Debug mode: off
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:4005
 * Running on http://203.253.25.165:4005
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:__main__:â±ï¸  Server idle for 120.1s (threshold: 120s)
INFO:__main__:ðŸ”Œ Unloading model from GPU...
INFO:__main__:âœ… GPU memory freed. Server remains active for auto-reload.
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 08:30:42] "[33mGET / HTTP/1.1[0m" 404 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 09:26:35] "[33mGET / HTTP/1.1[0m" 404 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:01:09] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:01:09] "GET /health HTTP/1.1" 200 -
INFO:__main__:ðŸ“¥ Heartbeat received with unloaded model - triggering auto-reload
INFO:__main__:ðŸ”„ Model not loaded. Reloading...
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:01:09] "POST /heartbeat HTTP/1.1" 200 -
INFO:__main__:Loading Qwen3-4B tokenizer from local path
INFO:__main__:Loading Qwen3-4B model with 4-bit quantization
INFO:accelerate.utils.modeling:We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:02<00:05,  2.95s/it]Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:06<00:03,  3.27s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:06<00:00,  2.18s/it]
INFO:__main__:âœ… Qwen3-4B model loaded successfully with 4-bit quantization
INFO:__main__:Model vocab size: 151936, Tokenizer vocab size: 151669
INFO:__main__:PAD token ID: 151643, EOS token ID: 151645
INFO:__main__:â±ï¸  Server idle for 120.6s (threshold: 120s)
INFO:__main__:ðŸ”Œ Unloading model from GPU...
INFO:__main__:âœ… GPU memory freed. Server remains active for auto-reload.
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:03:34] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:__main__:ðŸ“¥ Heartbeat received with unloaded model - triggering auto-reload
INFO:__main__:ðŸ”„ Model not loaded. Reloading...
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:03:34] "POST /heartbeat HTTP/1.1" 200 -
INFO:__main__:Loading Qwen3-4B tokenizer from local path
INFO:__main__:Loading Qwen3-4B model with 4-bit quantization
INFO:accelerate.utils.modeling:We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:02<00:05,  2.73s/it]Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:06<00:03,  3.16s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:06<00:00,  2.09s/it]
INFO:__main__:âœ… Qwen3-4B model loaded successfully with 4-bit quantization
INFO:__main__:Model vocab size: 151936, Tokenizer vocab size: 151669
INFO:__main__:PAD token ID: 151643, EOS token ID: 151645
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:03:45] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:03:45] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:04:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:04:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:04:46] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:04:46] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:05:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:05:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:05:48] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:05:48] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:06:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:06:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:06:45] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:06:46] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:07:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:07:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:07:46] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:07:46] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:08:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:08:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:08:46] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:08:46] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:09:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:09:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:09:46] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:09:46] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:10:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:10:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:10:46] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:10:46] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:11:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:11:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:11:46] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:11:46] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:12:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:12:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:12:47] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:12:48] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:13:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:13:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:13:46] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:13:46] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:14:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:14:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:14:46] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:14:46] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:15:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:15:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:15:46] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:15:46] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:16:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:16:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:16:46] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:16:46] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:17:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:17:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:17:46] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:17:46] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:18:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:18:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:18:45] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:18:46] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:19:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:19:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:19:40] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:19:40] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:19:51] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:19:51] "POST /heartbeat HTTP/1.1" 200 -
INFO:__main__:â±ï¸  Server idle for 129.6s (threshold: 120s)
INFO:__main__:ðŸ”Œ Unloading model from GPU...
INFO:__main__:âœ… GPU memory freed. Server remains active for auto-reload.
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:30:08] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:30:08] "GET /health HTTP/1.1" 200 -
INFO:__main__:ðŸ“¥ Heartbeat received with unloaded model - triggering auto-reload
INFO:__main__:ðŸ”„ Model not loaded. Reloading...
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:30:08] "POST /heartbeat HTTP/1.1" 200 -
INFO:__main__:Loading Qwen3-4B tokenizer from local path
INFO:__main__:Loading Qwen3-4B model with 4-bit quantization
INFO:accelerate.utils.modeling:We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:02<00:05,  2.72s/it]INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:30:14] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:30:14] "GET /health HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:30:14] "POST /heartbeat HTTP/1.1" 200 -
Loading checkpoint shards:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:06<00:03,  3.20s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:06<00:00,  1.79s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:06<00:00,  2.13s/it]
INFO:__main__:âœ… Qwen3-4B model loaded successfully with 4-bit quantization
INFO:__main__:Model vocab size: 151936, Tokenizer vocab size: 151669
INFO:__main__:PAD token ID: 151643, EOS token ID: 151645
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:30:44] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:30:44] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:31:15] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:31:15] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:31:38] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:31:38] "GET /health HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:31:38] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:32:10] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:32:10] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:32:38] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:32:38] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:34:03] "OPTIONS /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:34:03] "POST /heartbeat HTTP/1.1" 200 -
INFO:werkzeug:127.0.0.1 - - [18/Nov/2025 14:34:03] "GET /health HTTP/1.1" 200 -
